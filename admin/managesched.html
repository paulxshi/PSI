<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Dashboard</title>
    <link rel="icon" href="../imgs/PSI.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" defer></script>
    <link href="https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/dashstyle.css">
	<script src="js/managesched.js" defer></script>
</head>
<style>
.schedule-table tbody tr {
transition: background-color 0.2s ease;
}

.schedule-table tbody tr:hover {
background-color: #f9fafb;
}

.schedule-table td {
padding-top: 1rem;
padding-bottom: 1rem;
}

.page-header {
    padding: 15px 24px;
    border-bottom: 3px solid #acacac;
    max-width: 60%;
}

.page-title {
  font-weight: 800;
  font-size: 2rem;
  color: #000;
  margin-bottom: 0.75rem;
}

.page-description {
  font-size: 1rem;
  line-height: 1.7;
  color: #4b5563;
  margin: 0;
}
.btn-close:focus,
.no-focus:focus {
    outline: none;
    box-shadow: none;
}

</style>
<body>

    <!-- Sidebar Section -->
    <section id="sidebar">
        <a href="#" class="brand d-flex align-items-center">
            <img src="../imgs/PSI.png" alt="RHULogo" class="logo">
            <span class="text">PSI-ADMIN Portal</span>
        </a>

        <ul class="side-menu top">
            <li>
                <a href="dashboard.html">
                    <i class="bx bxs-dashboard"></i>
                    <span class="text">Dashboard</span>
                </a>
            </li>

            <li>
                <a href="schedule.html">
                    <i class="bx bx-calendar-check"></i>
                    <span class="text">Create Schedule</span>
                </a>
            </li>

            <li class="active">
                <a href="managesched.html">
                    <i class="bx bx-edit"></i>
                    <span class="text">Schedule Management </span>
                </a>
            </li>

            <li>
                <a href="masterlist.html">
                    <i class="bx bx-list-ul"></i>
                    <span class="text">Examinee Masterlist</span>
                </a>
            </li>

                <li>
                    <a href="examinee.html">
                        <i class="bx bx-group"></i>
                        <span class="text">Examinee Management</span>
                    </a>
                </li>  
                <li>
                    <a href="examhistory.html">
                        <i class="bx bx-history"></i>
                        <span class="text">Exam History</span>
                    </a>
                </li> 
                <li>
                    <a href="scanner.html">
                        <i class="bx bx-qr-scan"></i>
                        <span class="text">QR Scan</span>
                    </a>
                </li> 				
        </ul>

        <ul class="side-menu">
            <li>
                <a href="#" data-bs-toggle="modal" data-bs-target="#logoutModal">
                    <i class="bx bxs-log-out-circle"></i>
                    <span class="text">Logout</span>
                </a>
            </li>
        </ul>
    </section>

    <!-- Content Section -->
    <section id="content">
        <nav>
            <div class="greeting">
                <span>User</span>
            </div>
        </nav>

		<main class="p-4">

			<!-- Alert Container -->
			<div id="alertContainer" class="position-fixed top-0 end-0 p-3" style="z-index: 9999;"></div>

			<!-- Page Header -->
			<div class="page-header mb-4">
				<h2 class="page-title">
				Examination Schedule
				</h2>

				<p class="page-description">
				This module create, manage, and maintain official
				examination schedules, including venue details, capacity limits, examination fees,
				and availability status. All published schedules are made accessible to applicants
				and designated examination personnel.
				</p>
			</div>


			<!-- Schedule Container -->
			<div class="card border-0 rounded-4">
				<div class="card-body p-4">

					<!-- Controls -->
					<div class="row g-3 align-items-center mb-4">
						<div class="col-md-3">
							<input
								type="text"
								class="form-control"
								id="searchInput"
								placeholder="Search by venue or date..."
							>
						</div>

						<div class="col-md-2">
							<select class="form-select" id="regionFilter">
								<option value="">Filter by Region</option>
								<option value="Luzon">Luzon</option>
								<option value="Visayas">Visayas</option>
								<option value="Mindanao">Mindanao</option>
							</select>
						</div>

						<div class="col-md-2">
							<select class="form-select" id="statusFilter">
								<option value="">Filter by Status</option>
								<option value="Incoming">Incoming</option>
								<option value="Closed">Closed</option>
								<option value="Completed">Completed</option>
							</select>
						</div>

						<div class="col-md-2">
							<select class="form-select" id="sortFilter">
								<option value="">Sort by Date</option>
								<option value="newest">Newest First</option>
								<option value="oldest">Oldest First</option>
							</select>
						</div>

						<div class="col-md-2 text-md-end">
							<span class="text-muted small">
								Total: <strong id="totalCount">0</strong>
							</span>
						</div>
					</div>

					<!-- Modern Table -->
					<div class="table-responsive">
						<table class="table table-borderless align-middle mb-0 schedule-table">
							<thead>
								<tr class="text-uppercase small text-muted border-bottom">
									<th>#</th>
									<th>Region</th>
									<th>Venue</th>
									<th>Date</th>
									<th>Capacity</th>
									<th>Exam Fee</th>
									<th>Status</th>
									<th class="text-end">Actions</th>
								</tr>
							</thead>

							<tbody id="scheduleTableBody">
								<!-- Schedules will be loaded dynamically -->
								<tr>
									<td colspan="8" class="text-center py-5">
										<div class="spinner-border text-primary" role="status">
											<span class="visually-hidden">Loading...</span>
										</div>
										<p class="text-muted mt-2">Loading schedules...</p>
									</td>
								</tr>
							</tbody>
						</table>
					</div>

				</div>
			</div>

		</main>


    </section>

    <!-- Logout Modal -->
<div
    class="modal fade"
    id="logoutModal"
    tabindex="-1"
    aria-labelledby="logoutModalLabel"
    aria-hidden="true"
>
    <div class="modal-dialog modal-md modal-dialog-centered">
        <div class="modal-content border-0 rounded-4 shadow">

            <!-- Modal Header -->
            <div class="modal-header bg-light border-0 rounded-top-4 px-4 py-3">
                <h5 class="modal-title fw-bold mb-0" id="logoutModalLabel">
                    Confirm Logout
                </h5>
                <button
                    type="button"
                    class="btn-close no-focus"
                    data-bs-dismiss="modal"
                    aria-label="Close"
                ></button>
            </div>

            <!-- Divider -->
            <div class="px-4">
                <hr class="my-0">
            </div>

            <!-- Modal Body -->
            <div class="modal-body px-4 py-4 text-center">
                <i class="bx bx-log-out-circle fs-1 text-muted mb-3"></i>
                <p class="mb-0 text-muted">
                    Are you sure you want to log out of your account?
                </p>
            </div>

            <!-- Modal Footer -->
            <div class="modal-footer border-0 px-4 pb-4 pt-2 justify-content-center">
                <button
                    type="button"
                    class="btn btn-outline-secondary rounded-pill px-4"
                    data-bs-dismiss="modal"
                >
                    Cancel
                </button>
                <a
                    href="../php/logout.php"
                    class="btn btn-danger rounded-pill px-4"
                >
                    Logout
                </a>
            </div>

        </div>
    </div>
</div>

<!-- Edit Schedule Modal -->
<div class="modal fade" id="editScheduleModal" tabindex="-1" aria-labelledby="editScheduleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content border-0 rounded-4 shadow">
            
            <!-- Modal Header -->
            <div class="modal-header bg-light border-0 rounded-top-4 px-4 py-3">
                <h5 class="modal-title fw-bold mb-0" id="editScheduleModalLabel">
                    <i class='bx bx-edit me-2'></i>Edit Schedule
                </h5>
                <button type="button" class="btn-close no-focus" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <!-- Divider -->
            <div class="px-4">
                <hr class="my-0">
            </div>

            <!-- Modal Body -->
            <div class="modal-body px-4 py-4">
                <form id="editScheduleForm">
                    <input type="hidden" id="editScheduleId" name="schedule_id">
                    
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label for="editRegion" class="form-label fw-semibold">Region</label>
                            <select class="form-select" id="editRegion" name="region" required>
                                <option value="">Select Region</option>
                                <option value="Luzon">Luzon</option>
                                <option value="Visayas">Visayas</option>
                                <option value="Mindanao">Mindanao</option>
                            </select>
                        </div>

                        <div class="col-md-6">
                            <label for="editVenue" class="form-label fw-semibold">Venue</label>
                            <input type="text" class="form-control" id="editVenue" name="venue_name" required>
                        </div>

                        <div class="col-md-12">
                            <label for="editDate" class="form-label fw-semibold">Date</label>
                            <input type="date" class="form-control" id="editDate" name="date" required>
                        </div>

                        <div class="col-md-4">
                            <label for="editCapacity" class="form-label fw-semibold">Capacity</label>
                            <input type="number" class="form-control" id="editCapacity" name="capacity" min="1" required>
                        </div>

                        <div class="col-md-4">
                            <label for="editPrice" class="form-label fw-semibold">Exam Fee (â‚±)</label>
                            <input type="number" class="form-control" id="editPrice" name="price" min="0" step="0.01" required>
                        </div>

                        <div class="col-md-4">
                            <label for="editStatus" class="form-label fw-semibold">Status</label>
                            <select class="form-select" id="editStatus" name="status" required>
                                <option value="Incoming">Incoming</option>
                                <option value="Closed">Closed</option>
                                <option value="Completed">Completed</option>
                            </select>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Modal Footer -->
            <div class="modal-footer border-0 px-4 pb-4 pt-2">
                <button type="button" class="btn btn-outline-secondary rounded-pill px-4" data-bs-dismiss="modal">
                    Cancel
                </button>
                <button type="button" class="btn btn-primary rounded-pill px-4" id="saveScheduleBtn" onclick="saveScheduleChanges()">
                    Save Changes
                </button>
            </div>

        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="modal fade" id="deleteConfirmModal" tabindex="-1" aria-labelledby="deleteConfirmModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-md modal-dialog-centered">
        <div class="modal-content border-0 rounded-4 shadow">
            
            <!-- Modal Header -->
            <div class="modal-header bg-light border-0 rounded-top-4 px-4 py-3">
                <h5 class="modal-title fw-bold mb-0 text-danger" id="deleteConfirmModalLabel">
                    <i class='bx bx-trash me-2'></i>Delete Schedule
                </h5>
                <button type="button" class="btn-close no-focus" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <!-- Divider -->
            <div class="px-4">
                <hr class="my-0">
            </div>

            <!-- Modal Body -->
            <div class="modal-body px-4 py-4 text-center">
                <input type="hidden" id="deleteScheduleId">
                <i class='bx bx-error-circle fs-1 text-danger mb-3'></i>
                <h6 class="fw-bold mb-3">Are you sure you want to delete this schedule?</h6>
                <p class="text-muted mb-2">
                    Venue: <strong id="deleteVenueName"></strong>
                </p>
                <div class="alert alert-warning mt-3" role="alert">
                    <i class='bx bx-error me-1'></i>
                    <small>This action cannot be undone.</small>
                </div>
            </div>

            <!-- Modal Footer -->
            <div class="modal-footer border-0 px-4 pb-4 pt-2 justify-content-center">
                <button type="button" class="btn btn-outline-secondary rounded-pill px-4" data-bs-dismiss="modal">
                    Cancel
                </button>
                <button type="button" class="btn btn-danger rounded-pill px-4" id="confirmDeleteBtn" onclick="deleteSchedule()">
                    Delete Schedule
                </button>
            </div>

        </div>
    </div>
</div>

</body>
</html>
