<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="icon" href="imgs/PSI.png">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css" rel="stylesheet">
	<link rel="stylesheet" href="css/dashstyle.css">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

	<title>Test Permit</title>
</head>

<style>
  
.photo-box {
  cursor: pointer;
}

.upload-overlay {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.45);
  opacity: 0;
  transition: opacity 0.2s ease-in-out;
}

.photo-box:hover .upload-overlay {
  opacity: 1;
}

#permitPDF {
  font-family: "Times New Roman", Georgia, serif;
  color: #000;
  padding: 30px;
  max-width: 800px;
  margin: auto;
}

.permit-title {
  font-size: 18px;
  font-weight: bold;
  text-transform: uppercase;
  border: 2px solid #000;
  display: inline-block;
  padding: 6px 18px;
  margin-top: 15px;
}

@media print {
  main {
    margin-top: 0 !important;
    margin-bottom: 0 !important;
  }
}


@media print {

  /* Reset entire page */
  html, body {
    margin: 0 !important;
    padding: 0 !important;
    height: auto !important;
  }

  /* Completely remove non-PDF layout */
  #sidebar,
  nav,
  main > *:not(#permitPDF),
  .btn {
    display: none !important;
    height: 0 !important;
    overflow: hidden !important;
  }

  /* Remove Bootstrap container spacing */
  main {
    margin: 0 !important;
    padding: 0 !important;
  }

  /* Force permit to be FIRST printable content */
  #permitPDF {
    position: relative;
    top: 0;
    left: 0;

    margin: 0 auto !important;
    padding: 15mm 14mm !important;

    width: 210mm;
    min-height: 297mm;

    box-shadow: none !important;
    page-break-before: avoid !important;
  }

  /* Prevent phantom page */
  body {
    overflow: hidden !important;
  }
}


@media print {
  .print-signature {
    display: block !important;
  }
}

/* Also show during html2pdf */
body.print-mode .print-signature {
  display: block !important;
}

@media print {
body.print-mode #permitPDF {
  max-width: 210mm;
  min-height: 297mm;
  padding: 15mm 14mm;
  font-size: 12px;
  line-height: 1.3;
}

body.print-mode #permitPDF h6 {
  margin-bottom: 5px !important;
}

body.print-mode #permitPDF .row {
  margin-bottom: 6px !important;
}

body.print-mode #permitPDF .photo-box {
  width: 130px !important;
}

  main {
    padding: 0 !important;
  }

  .btn {
    display: none !important;
  }

  #sidebar, nav {
    display: none !important;
  }
  
  #permitPDF {
    box-shadow: none !important;
  }
  #permitPDF {
    max-width: 210mm;
    min-height: 297mm;
    padding: 15mm 14mm;
    font-size: 12px;
    line-height: 1.3;
  }

  /* Compact header */
  #permitPDF .text-center {
    margin-bottom: 8px !important;
  }

  #permitPDF hr {
    margin: 6px 0;
  }

  /* Section titles */
  #permitPDF h6 {
    margin-bottom: 5px !important;
    padding-bottom: 3px !important;
    font-size: 13px;
  }

  /* Reduce spacing between rows */
  #permitPDF .row {
    margin-bottom: 6px !important;
  }

  /* Photo size for print */
  #permitPDF .photo-box {
    width: 130px !important;
  }

  /* Lists */
  #permitPDF ol {
    padding-left: 16px;
    margin-bottom: 0;
  }

  #permitPDF li {
    margin-bottom: 2px;
  }

  /* Prevent page breaks */
  #permitPDF,
  #permitPDF * {
    page-break-inside: avoid !important;
  }

  /* Hide UI elements */
  .btn,
  #sidebar,
  nav {
    display: none !important;
  }

    body {
    background: #fff !important;
  }

  #permitPDF {
    max-width: 210mm;
    min-height: 297mm;
    padding: 15mm 14mm;
    font-size: 12px;
    line-height: 1.3;
    transform-origin: top center;
  }

  /* Compact spacing */
  #permitPDF h6 {
    font-size: 13px;
    margin-bottom: 5px !important;
    padding-bottom: 3px !important;
  }

  #permitPDF .row {
    margin-bottom: 6px !important;
  }

  #permitPDF hr {
    margin: 6px 0;
  }

  /* Prevent page breaks */
  #permitPDF,
  #permitPDF * {
    page-break-inside: avoid !important;
  }

  /* Hide UI */
  .btn,
  #sidebar,
  nav {
    display: none !important;
  }
}

/* Activate print layout during PDF generation */
body.print-mode #permitPDF {
  max-width: 210mm;
  min-height: 297mm;
  padding: 15mm 14mm;
  font-size: 12px;
  line-height: 1.3;

}


</style>


<body>
	<!-- Sidebar Section -->
		<section id="sidebar">
		<a href="#" class="brand" style="display: flex; align-items: center;">
			<img src="imgs/PSI.png" alt="RHULogo" class="logo">
			<span class="text">PSI-PMMA Portal</span>
		</a>
		<ul class="side-menu top">
			<li>
				<a href="dashboard.html">
					<i class="bx bxs-dashboard"></i>
					<span class="text">Dashboard</span>
				</a>
			</li>

			<li class="active">
				<a href="TestPermit.html">
				<i class="bx bx-pencil" /></i>
					<span class="text">Test Permit</span>
				</a>
			</li>
		</ul>

		<ul class="side-menu">
<li>
  <a href="#" data-bs-toggle="modal" data-bs-target="#logoutModal">
    <i class="bx bxs-log-out-circle"></i>
    <span class="text">Logout</span>
  </a>
</li>
</ul>
		
	</section>

	<section id="content">
		<nav>
      			<div class="greeting">
                <span>User</span>
            </div>
		</nav>

<!-- MAIN CONTENT -->
<main class="container py-3">

  <!-- PERMIT PDF AREA -->
  <div id="permitPDF" class="bg-white p-4 shadow-sm">

    <!-- HEADER -->
    <div class="text-center mb-4">
      <div class="d-flex justify-content-center align-items-center gap-5 mb-3">
        <img src="imgs/PSI.png" style="max-height:80px">
        <div>
          <h6 class="fw-bold text-uppercase mb-1">PSY Systems and Innovation, OPC</h6>
          <div class="small text-muted text-uppercase">Philippine Merchant Marine Academy</div>
          <div class="small text-muted text-uppercase">Psychological Evaluation</div>
        </div>
        <img src="imgs/PMMA.png" style="max-height:80px">
      </div>

      <h6 class="fw-bold text-uppercase mt-3">Test Permit</h6>
    </div>

    <hr>

    <!-- PHOTO -->
    <div class="d-flex justify-content-end mb-3">
      <div style="width:160px">
        <div class="border rounded ratio ratio-1x1 position-relative photo-box">

          <img id="photoPreview" class="img-fluid d-none w-100 h-100 object-fit-cover">

          <div id="photoPlaceholder"
               class="d-flex flex-column justify-content-center align-items-center small text-muted text-center h-100">
            <strong>2 × 2 Picture</strong>
            <span>white background</span>
          </div>

          <div class="upload-overlay d-flex justify-content-center align-items-center">
            <label for="photoInput" class="btn btn-sm btn-outline-light">
              Upload Photo
            </label>
          </div>
        </div>

        <input type="file" id="photoInput" accept="image/*" hidden>
      </div>
    </div>

    <!-- PERSONAL INFORMATION -->
    <h6 class="fw-bold text-uppercase border-bottom pb-2 mb-3">Personal Information</h6>

    <div class="row g-3 mb-4">
      <div class="col-md-6">
        <small class="text-muted">Test Permit No.</small>
        <div class="fw-semibold">050-2018</div>
      </div>
      <div class="col-md-6">
        <small class="text-muted">Status</small>
        <div class="fw-semibold text-success">Detected</div>
      </div>
      <div class="col-md-6">
        <small class="text-muted">Name of Examinee</small>
        <div class="fw-semibold">User</div>
      </div>
      <div class="col-md-6">
        <small class="text-muted">Date of Birth</small>
        <div class="fw-semibold">02/11/2026</div>
      </div>
      <div class="col-md-4">
        <small class="text-muted">Age</small>
        <div class="fw-semibold">18</div>
      </div>
      <div class="col-md-4">
        <small class="text-muted">Gender</small>
        <div class="fw-semibold">Male</div>
      </div>
      <div class="col-md-4">
        <small class="text-muted">Nationality</small>
        <div class="fw-semibold">Filipino</div>
      </div>
      <div class="col-md-4">
        <small class="text-muted">Contact Number</small>
        <div class="fw-semibold">09123456789</div>
      </div>
      <div class="col-md-4">
        <small class="text-muted">Email Address</small>
        <div class="fw-semibold">example@gmail.com</div>
      </div>
    </div>

    <!-- SCHEDULE -->
    <h6 class="fw-bold text-uppercase border-bottom pb-2 mb-3">Schedule of Examination</h6>

    <div class="row g-3 mb-4">
      <div class="col-md-6">
        <small class="text-muted">Date of Testing</small>
        <div class="fw-semibold">05/27/2025</div>
      </div>
      <div class="col-md-6">
        <small class="text-muted">Venue</small>
        <div class="fw-semibold">Manila</div>
      </div>
    </div>

    <!-- PAYMENT -->
    <h6 class="fw-bold text-uppercase border-bottom pb-2 mb-3">Payment Details</h6>

    <div class="row g-3 mb-4">
      <div class="col-md-4">
        <small class="text-muted">Transaction No.</small>
        <div class="fw-semibold">123456789</div>
      </div>
      <div class="col-md-4">
        <small class="text-muted">Payment Date</small>
        <div class="fw-semibold">02/11/2026</div>
      </div>
      <div class="col-md-4">
        <small class="text-muted">Amount</small>
        <div class="fw-semibold">₱100.00</div>
      </div>
    </div>

    <!-- GUIDELINES -->
    <h6 class="fw-bold text-uppercase border-bottom pb-2 mb-3">Guidelines</h6>

    <ol class="small text-muted">
      <li> Please bring this test permit on examination day.</li>
      <li>Attach 2×2 ID picture with name tag in white background.</li>
      <li>Wear white shirt, maong pants, and rubber shoes on examination day.</li>
      <li>Bring a valid ID for verification purposes.</li>
      <li>Bring 2 pencils, eraser, sharpener.</li>
      <li>Bring snacks (to be consumed outside the testing room).</li>
      <li>No cellphone inside the testing room.</li>
    </ol>

    <!-- PRINT-ONLY SIGNATURE -->
<div class="print-signature mt-4 d-none">
  <p class="fst-italic mb-4">Verified by:</p>

  <div style="margin-top:40px; width:260px;">
    <div style="border-bottom:1px solid #000; height:30px;"></div>
    <div class="small text-center mt-1">
      Signature over Printed Name
    </div>
    <div class="small fst-italic text-center mt-1">
      (to be filled by the official representative of PSI)
    </div>
  </div>
</div>

  </div>

<div class="d-flex justify-content-center mt-4">
  <button id="generatePDF" class="btn btn-danger px-4 py-2">
    <i class="bx bx-download me-2"></i>
    Generate PDF
  </button>
</div>

</main>

<!-- SCRIPTS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<script>
  // PHOTO UPLOAD
  const photoInput = document.getElementById('photoInput');
  const photoPreview = document.getElementById('photoPreview');
  const photoPlaceholder = document.getElementById('photoPlaceholder');

  photoInput.addEventListener('change', () => {
    const file = photoInput.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = e => {
      photoPreview.src = e.target.result;
      photoPreview.classList.remove('d-none');
      photoPlaceholder.classList.add('d-none');
    };
    reader.readAsDataURL(file);
  });

document.getElementById('generatePDF').addEventListener('click', async () => {
  const permit = document.getElementById('permitPDF');

  document.body.classList.add('print-mode');

  await html2pdf().set({
    margin: 0,
    filename: 'PMMA_Test_Permit.pdf',
    image: { type: 'jpeg', quality: 0.98 },
    html2canvas: {
      scale: 2,
      useCORS: true,
      scrollY: 0
    },
    jsPDF: {
      unit: 'mm',
      format: 'a4',
      orientation: 'portrait'
    },
    pagebreak: { mode: ['avoid-all'] }
  }).from(permit).save();

  document.body.classList.remove('print-mode');
});

</script>

</body>
</html>

