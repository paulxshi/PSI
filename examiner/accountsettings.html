<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="icon" href="../imgs/PSI.png">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css" rel="stylesheet">
	<link rel="stylesheet" href="../css/dashstyle.css">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

	<title>Test Permit</title>
</head>

<style>
/* Overlay on Avatar */
.avatar-wrapper {
  position: relative; /* Required for overlay positioning */
}

.avatar-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5); 
  color: #ffffff;
  font-size: 0.7rem;
  padding: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  border-radius: 50%;
  line-height: 1.2;
  pointer-events: none; /* click goes through overlay */
  font-weight: 500;
}

/* Hide overlay when image is uploaded */
.avatar-wrapper img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: none;
}

/* Hide overlay when image is shown */
.avatar-wrapper img[style*="display: block"] ~ .avatar-overlay,
.avatar-wrapper img:not([style*="display: none"]) ~ .avatar-overlay {
  display: none;
}

#profileHeader {
  letter-spacing: 0.1em; /* Adds more space between letters */
  font-size: 1rem;
  color: #111827;
  text-transform: uppercase; /* Optional: uppercase for a premium feel */
}

#btnViewPermit:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

#globalEditButton {
  display: inline-flex;
  align-items: center;
  font-size: 0.85rem;
  text-decoration: none;
  color: #475569;
  background: #f1f5f9;
  padding: 8px 16px;
  border-radius: 8px;
  border: 1px solid #e2e8f0;
  font-weight: 600;
  transition: all 0.2s ease;
  margin-right: 60px;
}

#globalEditButton:hover {
  background: #0f172a;
  color: #ffffff;
  border-color: #0f172a;
}

#globalEditButton:active {
  transform: scale(0.98);
}

#globalEditButton i {
  margin-right: 6px;
  font-size: 1rem;
}
/* ===== Field Group ===== */
.field-group {
  display: flex;
  flex-direction: column;
}

.field-group label {
  font-size: 0.72rem;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: #8a8f98;
  margin-bottom: 2px;
}

.field-value {
  font-size: 0.95rem;
  font-weight: 500;
  color: #2e2f33;
}

/* Status Pill */
.status-pill {
  display: inline-flex;
  align-items: center;
  padding: 5px 14px;
  font-size: 0.75rem;
  font-weight: 500;
  border-radius: 999px;
  width: fit-content;
}

.status-issued {
  background: rgba(34, 197, 94, 0.14);
  color: #15803d;
}
/* ===== Status Pills ===== */
.status-pill {
  display: inline-flex;
  align-items: center;
  padding: 5px 14px;
  font-size: 0.75rem;
  font-weight: 500;
  border-radius: 999px;
  width: fit-content;
}

.status-issued {
  background: rgba(34, 197, 94, 0.14);
  color: #15803d;
}

/* Optional states */
.status-pending {
  background: rgba(234, 179, 8, 0.18);
  color: #92400e;
}

.status-none {
  background: rgba(239, 68, 68, 0.15);
  color: #991b1b;
}

/* ===== Name Emphasis ===== */
.field-group .fw-semibold {
  font-size: 0.9rem;
  letter-spacing: -0.2px;
}

.account-shell {
  max-width: 980px;
  background: rgba(255, 255, 255, 0.9);
  backdrop-filter: blur(14px);
  border-radius: 16px;
  padding: 20px;
}

/* ===== Header ===== */
.account-header h3 {
  letter-spacing: -0.3px;
}

/* ===== Info Panel ===== */
.account-panel {
  display: grid;
  grid-template-columns: 1fr;
  gap: 12px;
}

.field-group label {
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: #8a8f98;
  margin-bottom: 2px;
  display: block;
}

.field-value {
  font-size: 0.85rem;
  font-weight: 500;
  color: #2e2f33;
}

/* ===== Status Pill ===== */
.status-pill {
  display: inline-block;
  padding: 4px 12px;
  font-size: 0.75rem;
  font-weight: 500;
  border-radius: 999px;
  background: rgba(34, 197, 94, 0.12);
  color: #16a34a;
}

/* Edit Button Style */
.btn-link {
  color: #3b82f6;  
  font-size: 0.85rem;
  text-decoration: none;
  padding: 0;
  margin-top: 4px;
}

.btn-link:hover {
  color: #2563eb;  
}

/* ===== Avatar Panel ===== */
.upload-card {
  max-width: 200px;
  margin: 0 auto;
}

.upload-area {
  display: block;
  padding: 16px 12px 14px;
  border-radius: 14px;
  background: #f7f8fb;
  cursor: pointer;
  transition: background 0.25s ease, transform 0.25s ease;
}


.upload-area:hover {
  background: #f1f3f8;
  transform: translateY(-1px);
}

/* ===== Avatar ===== */
.avatar-wrapper {
  width: 130px;
  height: 130px;
  margin: 0 auto 8px;
  border-radius: 50%;
  background: #ffffff;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

.avatar-wrapper img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: none;
}

.avatar-placeholder {
  font-size: 42px;
  color: #b0b6c3;
}

/* ===== Text ===== */
.upload-text {
  font-size: 0.8rem;
  font-weight: 500;
  color: #2f3137;
  margin: 0;
}

/* ===== Buttons ===== */
.btn-soft {
  background: #ffffff;
  border: 1px solid #e3e6ee;
  color: #3a3f45;
  border-radius: 12px;
}

.btn-soft:hover {
  background: #f4f6fb;
}

.btn-ghost {
  background: transparent;
  border: none;
  color: #6b7280;
}

.account-actions {
  display: flex;
  justify-content: flex-end;
  gap: 12px;
}
/* ===== Form Actions Container ===== */
.form-actions {
  gap: 10px;
  margin-top: 16px;
  padding-top: 12px;
  border-top: 1px solid #eef0f4;
}

/* ===== Cancel Button ===== */
.btn-cancel {
  background: transparent;
  border: 1px solid #e5e7eb;
  color: #6b7280;
  padding: 10px 18px;
  font-size: 0.9rem;
  font-weight: 500;
  border-radius: 10px;
  transition: all 0.2s ease;
}

.btn-cancel:hover {
  background: #f4f5f7;
  color: #111827;
}

/* ===== Save Button (Primary Black) ===== */
.btn-save {
  background: #0f172a; /* deep black / slate */
  color: #ffffff;
  border: none;
  padding: 10px 22px;
  font-size: 0.9rem;
  font-weight: 500;
  border-radius: 10px;
  transition: all 0.25s ease;
  box-shadow: 0 4px 12px rgba(15, 23, 42, 0.18);
}

.btn-save:hover {
  background: #020617;
  transform: translateY(-1px);
  box-shadow: 0 6px 16px rgba(15, 23, 42, 0.25);
}

.btn-save:active {
  transform: translateY(0);
  box-shadow: 0 3px 8px rgba(15, 23, 42, 0.2);
}

/* ===== Reminders Card ===== */
.reminders-card {
  margin-top: 16px;
  padding: 16px 16px;
  border-radius: 14px;
  background: #ffffff;
  border: 1px solid #eef0f4;
  max-width: 240px;
  margin-left: auto;
  margin-right: auto;
}

/* ===== Title ===== */
.reminders-title {
  font-size: 0.85rem;
  font-weight: 600;
  color: #111827;
  margin-bottom: 10px;
}

/* ===== List ===== */
.reminders-list {
  list-style: none;
  padding: 0;
  margin: 0 0 12px;
}

.reminders-list li {
  display: flex;
  align-items: flex-start;
  gap: 8px;
  font-size: 0.8rem;
  color: #374151;
  margin-bottom: 6px;
  line-height: 1.3;
}

.reminders-list i {
  color: #16a34a;
  font-size: 1rem;
  margin-top: 2px;
}

/* ===== Mobile ===== */
@media (max-width: 768px) {
  .account-shell {
    padding: 24px;
  }
} 

@media (max-width: 991px) {
  .upload-card,
  .reminders-card {
    margin-bottom: 0;
  }
  
  /* Smaller sizes for horizontal mobile layout */
  .upload-card {
    max-width: 140px;
  }
  
  .avatar-wrapper {
    width: 80px !important;
    height: 80px !important;
  }
  
  .avatar-placeholder {
    font-size: 28px !important;
  }
  
  .avatar-overlay {
    font-size: 0.6rem !important;
    padding: 4px !important;
  }
  
  .reminders-card {
    max-width: 100%;
    margin-left: 0;
    margin-right: 0;
  }
  
  #profileHeader {
    font-size: 0.9rem;
    margin-bottom: 8px !important;
  }
  
  .upload-text {
    font-size: 0.7rem;
  }
}

/* ===== Shake Animation ===== */
@keyframes shake {
  0%, 100% { transform: translateX(0); }
  10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
  20%, 40%, 60%, 80% { transform: translateX(5px); }
}
</style>


<body>
	<!-- Sidebar Section -->
		<section id="sidebar">
		<a href="#" class="brand" style="display: flex; align-items: center;">
			<img src="../imgs/PSI.png" alt="PSILogo" class="logo">
			<span class="text">PSI-PMMA Portal</span>
		</a>
		<ul class="side-menu top">
			<li>
				<a href="dashboard.html">
					<i class="bx bxs-dashboard"></i>
					<span class="text">Dashboard</span>
				</a>
			</li>

      <li class="active">
        <a href="accountsettings.html">
          <i class="bx bx-cog ms-1"></i>
          <span class="text">Account Settings</span>
        </a>
      </li>
		</ul>

		<ul class="side-menu">
      <li>
        <a href="#" data-bs-toggle="modal" data-bs-target="#logoutModal">
          <i class="bx bxs-log-out-circle"></i>
          <span class="text">Logout</span>
        </a>
      </li>
      </ul>
		
	</section>

	<section id="content">

<main class="container py-5">

  <div class="account-shell mx-auto">

    <!-- Header -->
    <div class="account-header mb-3" style="display: flex; justify-content: space-between; align-items: flex-start;">
      <div>
        <h3 class="fw-semibold mb-1">Account Settings</h3>
        <p class="text-muted small mb-0">Manage your personal and examination information</p>
      </div>
      
      <!-- Edit Information Button -->
      <button type="button" id="globalEditButton">
        <i class="bx bx-edit"></i> 
        <span class="d-none d-sm-inline">Edit Information</span>
        <span class="d-sm-none">Edit</span>
      </button>
    </div>

    <div class="row g-4">
      <!-- LEFT: DETAILS (Bottom on mobile, Left on desktop) -->
      <div class="col-12 col-lg-8 order-2 order-lg-1">
        <div class="account-panel">

          <!-- TOP ROW: ACCOUNT TYPE - TEST PERIT - STATUS -->
          <div class="row g-2 align-items-center">

            <div class="col-md-4">
              <div class="field-group">
                <label>Account Type</label>
                <div class="field-value">Examinee</div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="field-group">
                <label>Test Permit</label>
                <div class="field-value" id="account-test-permit">
                  TP-2026-00123
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="field-group">
                <label>Status</label>
                <span class="status-pill status-issued">
                  Active
                </span>
              </div>
            </div>

          </div>

          <!-- FULL NAME -->
          <div class="row g-2 mt-2">
            <!-- Last Name -->
            <div class="col-md-4">
              <div class="field-group">
                <label>Last Name</label>
                <div class="field-value" id="lname">
                  Dela Cruz
                </div>
              </div>
            </div>
            <!-- First Name -->
            <div class="col-md-4">
              <div class="field-group">
                <label>First Name</label>
                <div class="field-value" id="fname">
                  Juan
                </div>
              </div>
            </div>
            <!-- Middle Name -->
            <div class="col-md-4">
              <div class="field-group">
                <label>Middle Name</label>
                <div class="field-value" id="mname">
                  M.
                </div>
              </div>
            </div>
          </div>

          <!-- CONTACT DETAILS -->
          <div class="row g-2 mt-1">
            <!-- Email Address -->
            <div class="col-md-6">
              <div class="field-group">
                <label>Email Address</label>
                <div class="field-value" id="email">
                  user@email.com
                </div>
                <!-- Edit Button for Email Address -->
              </div>
            </div>

            <!-- Contact Number -->
            <div class="col-md-6">
              <div class="field-group">
                <label>Contact Number</label>
                <div class="field-value" id="contact">
                  09XXXXXXXXX
                </div>
              </div>
            </div>
          </div>

          <!-- BIRTHDAY & AGE -->
          <div class="row g-2 mt-1">
            <!-- Age -->
            <div class="col-md-6">
              <div class="field-group">
                <label>Age</label>
                <div class="field-value" id="age">
                  24
                </div>
              </div>
            </div>

            <!-- Birthday -->
            <div class="col-md-6">
              <div class="field-group">
                <label>Birthday</label>
                <div class="field-value" id="birthday">
                  January 01, 2000
                </div>
              </div>
            </div>
          </div>

          <!-- SCHOOL & OTHER DETAILS -->
          <div class="row g-2 mt-1">
            <div class="col-md-4">
              <div class="field-group">
                <label>School</label>
                <div class="field-value" id="school">
                  Philippine Maritime Institute
                </div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="field-group">
                <label>Exam Date</label>
                <div class="field-value" id="account-exam-date">—</div>
              </div>
            </div>

            <div class="col-md-4">
              <div class="field-group">
                <label>Exam Venue</label>
                <div class="field-value" id="account-exam-venue">—</div>
              </div>
            </div>
          </div>

            <!-- ACTIONS INSIDE CONTAINER -->
            <div class="form-actions" style="display: none;">
            <button type="button" class="btn btn-cancel">
                Cancel
            </button>
            <button type="submit" class="btn btn-save">
                Save changes
            </button>
            </div>
        </div>
      </div>

      <!-- RIGHT: AVATAR & REMINDERS (Top on mobile, Right on desktop) -->
      <div class="col-12 col-lg-4 order-1 order-lg-2" style="display: flex; flex-direction: column; align-items: center;">
        <!-- Horizontal row for mobile, vertical for desktop -->
        <div class="row w-100 g-3">
          <!-- User Profile Section -->
          <div class="col-12 col-md-6 col-lg-12">
            <div class="text-center">
              <h5 class="mb-2 fw-semibold" id="profileHeader">User Profile</h5>
              <div class="upload-card text-center mx-auto">
                <label for="avatarInput" class="upload-area">
                  <div class="avatar-wrapper position-relative">
                    <img id="avatarPreview" alt="Profile Picture" />
                    <i class="bx bx-user avatar-placeholder" id="avatarIcon"></i>
                    <div id="avatarOverlay" class="avatar-overlay text-center">
                      Please upload a recent 2×2 profile photo with a white background.
                    </div>
                  </div>
                  <p class="upload-text">Upload picture</p>
                </label>
                <input type="file" id="avatarInput" accept="image/*" hidden />
              </div>
            </div>
          </div>

          <!-- REMINDERS -->
          <div class="col-12 col-md-6 col-lg-12">
            <div class="reminders-card">
              <h6 class="reminders-title">Important Reminders</h6>
              <ul class="reminders-list">
                <li><i class="bx bx-check-circle"></i> A profile picture is required to view your test permit.</li>
                <li><i class="bx bx-check-circle"></i> Profile uploads are limited to 3 attempts only</li>
                <li><i class="bx bx-check-circle"></i> Ensure your personal details are correct.</li>
                <li><i class="bx bx-check-circle"></i> Bring your Test Permit on examination day.</li>
                <li><i class="bx bx-check-circle"></i> Bring a valid ID on examination day.</li>
                <li><i class="bx bx-check-circle"></i> Arrive at the venue at least 30 minutes early.</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
        
     </div>
    </div>

 </div>

</main>


<!-- Logout Confirmation Modal -->
<div
  class="modal fade"
  id="logoutModal"
  tabindex="-1"
  aria-labelledby="logoutModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered logout-modal">
    <div class="modal-content border-0 rounded-4 shadow">

      <!-- Header -->
      <div class="modal-header bg-light border-0 rounded-top-4 px-4 py-3">
        <h5 class="modal-title fw-bold mb-0" id="logoutModalLabel">
          Confirm Logout
        </h5>
        <button
          type="button"
          class="btn-close no-focus"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>

      <!-- Divider -->
      <div class="px-4">
        <hr class="my-0">
      </div>

      <!-- Body -->
      <div class="modal-body px-4 py-4 text-center">
        <i class="bx bx-log-out-circle fs-1 text-muted mb-3"></i>
        <p class="mb-0 text-muted">
          Are you sure you want to log out of your account?
        </p>
      </div>

      <!-- Footer -->
      <div class="modal-footer border-0 px-4 pb-4 pt-2 justify-content-center">
        <button
          type="button"
          class="btn btn-outline-secondary rounded-pill px-4"
          data-bs-dismiss="modal"
        >
          Cancel
        </button>
        <a
          href="../php/logout.php"
          class="btn btn-danger rounded-pill px-4"
        >
          Logout
        </a>
      </div>

    </div>
  </div>
</div>

<!-- Success Modal -->
<div
  class="modal fade"
  id="successModal"
  tabindex="-1"
  aria-labelledby="successModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content border-0 rounded-4 shadow">

      <!-- Header -->
      <div class="modal-header bg-light border-0 rounded-top-4 px-4 py-3">
        <h5 class="modal-title fw-bold mb-0" id="successModalLabel">
          User Profile Picture Updated Successfully
        </h5>
        <button
          type="button"
          class="btn-close no-focus"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>

      <!-- Divider -->
      <div class="px-4">
        <hr class="my-0">
      </div>

      <!-- Body -->
      <div class="modal-body px-4 py-4 text-center">
        <i class="bx bx-check-circle fs-1 text-success mb-3"></i>
        <p class="mb-0 text-muted">
          Your profile picture has been uploaded successfully. You may now proceed to the dashboard to view your Test Permit.
        </p>
      </div>

      <!-- Footer -->
      <div class="modal-footer border-0 px-4 pb-4 pt-2 justify-content-center">
        <button
          type="button"
          class="btn btn-success rounded-pill px-4"
          data-bs-dismiss="modal"
        >
          OK
        </button>
      </div>

    </div>
  </div>
</div>

<!-- Error Modal -->
<div
  class="modal fade"
  id="errorModal"
  tabindex="-1"
  aria-labelledby="errorModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content border-0 rounded-4 shadow">

      <!-- Header -->
      <div class="modal-header bg-light border-0 rounded-top-4 px-4 py-3">
        <h5 class="modal-title fw-bold mb-0" id="errorModalLabel">
          Upload Failed
        </h5>
        <button
          type="button"
          class="btn-close no-focus"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>

      <!-- Divider -->
      <div class="px-4">
        <hr class="my-0">
      </div>

      <!-- Body -->
      <div class="modal-body px-4 py-4 text-center">
        <i class="bx bx-x-circle fs-1 text-danger mb-3"></i>
        <p class="mb-0 text-muted">
          There was an error uploading your profile picture. Please try again. If the problem persists, contact support.
        </p>
      </div>

      <!-- Footer -->
      <div class="modal-footer border-0 px-4 pb-4 pt-2 justify-content-center">
        <button
          type="button"
          class="btn btn-danger rounded-pill px-4"
          data-bs-dismiss="modal"
        >
          Close
        </button>
      </div>

    </div>
  </div>
</div>

<!-- Personal Info Update Success Modal -->
<div
  class="modal fade"
  id="infoSuccessModal"
  tabindex="-1"
  aria-labelledby="infoSuccessModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content border-0 rounded-4 shadow">

      <!-- Header -->
      <div class="modal-header bg-light border-0 rounded-top-4 px-4 py-3">
        <h5 class="modal-title fw-bold mb-0" id="infoSuccessModalLabel">
          Personal Information Updated Successfully
        </h5>
        <button
          type="button"
          class="btn-close no-focus"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>

      <!-- Divider -->
      <div class="px-4">
        <hr class="my-0">
      </div>

      <!-- Body -->
      <div class="modal-body px-4 py-4 text-center">
        <i class="bx bx-check-circle fs-1 text-success mb-3"></i>
        <p class="mb-0 text-muted">
          Your personal information has been updated successfully.
        </p>
      </div>

      <!-- Footer -->
      <div class="modal-footer border-0 px-4 pb-4 pt-2 justify-content-center">
        <button
          type="button"
          class="btn btn-success rounded-pill px-4"
          data-bs-dismiss="modal"
        >
          OK
        </button>
      </div>

    </div>
  </div>
</div>

<!-- Personal Info Update Error Modal -->
<div
  class="modal fade"
  id="infoErrorModal"
  tabindex="-1"
  aria-labelledby="infoErrorModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content border-0 rounded-4 shadow">

      <!-- Header -->
      <div class="modal-header bg-light border-0 rounded-top-4 px-4 py-3">
        <h5 class="modal-title fw-bold mb-0" id="infoErrorModalLabel">
          Update Failed
        </h5>
        <button
          type="button"
          class="btn-close no-focus"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>

      <!-- Divider -->
      <div class="px-4">
        <hr class="my-0">
      </div>

      <!-- Body -->
      <div class="modal-body px-4 py-4 text-center">
        <i class="bx bx-x-circle fs-1 text-danger mb-3"></i>
        <p class="mb-0 text-muted">
          There was an error updating your personal information. Please try again. If the problem persists, contact support.
        </p>
      </div>

      <!-- Footer -->
      <div class="modal-footer border-0 px-4 pb-4 pt-2 justify-content-center">
        <button
          type="button"
          class="btn btn-danger rounded-pill px-4"
          data-bs-dismiss="modal"
        >
          Close
        </button>
      </div>

    </div>
  </div>
</div>

<script src="js/accountsettings.js"></script>

<script>
// Check user session on page load
(function() {
    fetch('php/check_session.php', {
        method: 'GET',
        credentials: 'same-origin'
    })
    .then(response => response.json())
    .then(data => {
        if (!data.authenticated) {
            // Redirect to login if not authenticated
            window.location.href = '../login.html';
        }
    })
    .catch(error => {
        console.error('Session check failed:', error);
        window.location.href = '../login.html';
    });
})();
</script>

</body>
</html>

